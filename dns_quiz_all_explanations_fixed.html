<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNS Security Quiz</title>
    <style>
        :root {
            --primary: #0d47a1;
            --accent: #1976d2;  
            --success: #388e3c;
            --error: #d32f2f;
            --bg: #f5f5f5;
        }
        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px 0;
        }
        .quiz-card {
            background: #fff;
            max-width: 800px;
            width: 95%;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
            padding: 32px;
            margin: 20px;
        }
        h1 {
            margin: 0 0 8px 0;
            color: var(--primary);
            font-size: 28px;
            font-weight: 600;
        }
        #progress {
            margin-bottom: 20px;
            font-weight: 600;
            color: var(--accent);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .question-title {
            color: var(--primary);
            margin-bottom: 16px;
            font-size: 20px;
            font-weight: 600;
        }
        .question-text {
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 24px;
            color: #333;
        }
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 20px 0;
        }
        .btn-option {
            padding: 16px 20px;
            border: 2px solid #e1e5e9;
            background: #fff;
            cursor: pointer;
            border-radius: 8px;
            text-align: left;
            transition: all 0.3s ease;
            font-size: 15px;
            color: #333;
        }
        .btn-option:hover:not(.disabled) {
            background: #f8f9fa;
            border-color: var(--accent);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(25, 118, 210, 0.15);
        }
        .btn-option.correct {
            background: var(--success);
            color: #fff;
            border-color: var(--success);
            box-shadow: 0 4px 12px rgba(56, 142, 60, 0.3);
        }
        .btn-option.wrong {
            background: var(--error);
            color: #fff;
            border-color: var(--error);
            box-shadow: 0 4px 12px rgba(211, 47, 47, 0.3);
        }
        .btn-option.disabled {
            cursor: default;
            opacity: 0.8;
        }
        .feedback {
            border-top: 3px solid #e0e0e0;
            padding-top: 24px;
            margin-top: 24px;
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .feedback h3 {
            color: var(--primary);
            margin-bottom: 16px;
            font-size: 18px;
            font-weight: 600;
        }
        .explanation-container {
            max-height: 350px;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            background: #fafbfc;
            margin-bottom: 20px;
            scroll-behavior: smooth;
        }
        .explanation-container::-webkit-scrollbar {
            width: 6px;
        }
        .explanation-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }
        .explanation-container::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }
        .explanation-container::-webkit-scrollbar-thumb:hover {
            background: #a1a1a1;
        }
        #explanation {
            line-height: 1.7;
            color: #444;
        }
        #explanation strong {
            color: var(--primary);
            font-weight: 600;
        }
        #explanation ul, #explanation ol {
            margin-left: 24px;
            margin-bottom: 16px;
        }
        #explanation li {
            margin-bottom: 6px;
        }
        #explanation h4 {
            color: var(--primary);
            margin-top: 20px;
            margin-bottom: 8px;
            font-size: 16px;
        }
        .btn {
            padding: 14px 28px;
            background: var(--accent);
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .btn:hover {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(13, 71, 161, 0.3);
        }
        .hidden {
            display: none;
        }
        .results {
            text-align: center;
            animation: fadeIn 0.6s ease-in;
        }
        .results h2 {
            color: var(--primary);
            margin-bottom: 24px;
            font-size: 24px;
        }
        .score-display {
            margin: 24px 0;
            padding: 24px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 2px solid #e9ecef;
        }
        .score-display div {
            margin: 12px 0;
            font-size: 18px;
        }
        #score-number {
            font-size: 32px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 8px;
        }
        #score-percentage {
            font-size: 20px;
            font-weight: 600;
            color: var(--accent);
        }
        #score-message {
            font-size: 16px;
            color: #666;
            font-style: italic;
            margin-top: 16px;
        }
        #restart-btn {
            width: 100%;
            max-width: 240px;
            margin-top: 20px;
        }

        @media (max-width: 600px) {
            .quiz-card {
                padding: 20px;
                margin: 10px;
            }
            h1 {
                font-size: 24px;
            }
            .question-title {
                font-size: 18px;
            }
            .btn-option {
                font-size: 14px;
                padding: 14px 16px;
            }
            .explanation-container {
                max-height: 280px;
                padding: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="quiz-card">
        <h1>DNS Security Quiz</h1>
        <div id="progress">Vraag 1 van 10</div>
        <div class="question-section" id="question-section">
            <h2 class="question-title" id="question-title"></h2>
            <p class="question-text" id="question-text"></p>
            <div class="options-container" id="options-container"></div>

            <div class="feedback hidden" id="feedback">
                <h3>Uitgebreide Uitleg</h3>
                <div class="explanation-container">
                    <div id="explanation"></div>
                </div>
                <button class="btn" id="next-btn">Volgende vraag</button>
            </div>
        </div>

        <div class="results hidden" id="results">
            <h2>Quiz Resultaat</h2>
            <div class="score-display">
                <div id="score-number"></div>
                <div id="score-percentage"></div>
                <div id="score-message"></div>
            </div>
            <button class="btn" id="restart-btn">Opnieuw</button>
        </div>
    </div>

    <script type="application/json" id="quiz-data">[
  {
    "id": 1,
    "title": "DNS Cache Poisoning",
    "question": "Wat is het hoofddoel van DNS cache poisoning (ook bekend als DNS spoofing)?",
    "options": [
      "A) Het verhogen van DNS query snelheid",
      "B) Het omzeilen van DNS rate limiting",
      "C) Het omleiden van legitiem verkeer naar kwaadaardige websites",
      "D) Het versleutelen van DNS verkeer"
    ],
    "correct_answer": "C",
    "explanation": "DNS cache poisoning, ook wel DNS spoofing genoemd, is een van de meest voorkomende en gevaarlijke DNS-aanvallen. Het hoofddoel van deze aanval is **het omleiden van legitiem verkeer naar kwaadaardige websites** door valse DNS-informatie in de cache van een DNS-resolver in te voegen.\n\n**Hoe werkt DNS cache poisoning:**\n\n1. **Doelwitstelling**: Aanvallers identificeren een DNS-resolver die ze willen compromitteren\n2. **Valse responsen**: Ze sturen nep-DNS-responsen naar de resolver voordat de legitieme respons arriveert\n3. **Cache vervuiling**: De resolver slaat de valse informatie op in zijn cache\n4. **Traffic omleiding**: Alle toekomstige queries voor dat domein worden omgeleid naar de kwaadaardige server\n\n**Praktische gevolgen:**\n\n- **Phishing aanvallen**: Gebruikers worden omgeleid naar namaakwebsites die eruit zien als legitieme sites om inloggegevens te stelen\n- **Malware distributie**: Bezoekers krijgen malware ge√Ønjecteerd via gecompromitteerde websites\n- **Man-in-the-middle aanvallen**: Aanvallers kunnen al het verkeer tussen gebruiker en website onderscheppen\n\n**Waarom de andere opties fout zijn:**\n\n- **Optie A**: DNS cache poisoning heeft niets te maken met het verhogen van query snelheid\n- **Optie B**: Rate limiting omzeilen is geen doel van cache poisoning\n- **Optie D**: Cache poisoning versleutelt geen verkeer, het corrumpeert juist de DNS-data\n\n**Verdedigingsmaatregelen:**\n\n- **DNSSEC implementeren**: Dit voegt digitale handtekeningen toe aan DNS-records om authenticiteit te garanderen\n- **DNS cache locking**: Voorkomt dat gecachte data wordt gewijzigd voordat de TTL verloopt\n- **Monitoring**: Regelmatige controle op ongebruikelijke DNS-patronen en responsen\n\nEen beroemd voorbeeld van DNS cache poisoning was de aanval op Curve Finance in 2022, waarbij aanvallers de frontend van de website vervingen door een kwaadaardige versie, wat resulteerde in \\$570.000 aan gestolen fondsen."
  },
  {
    "id": 2,
    "title": "DNSSEC Fundamentals",
    "question": "Welke veiligheidsmaatregel is specifiek ontworpen om DNS-antwoorden te authenticeren en data-integriteit te garanderen?",
    "options": [
      "A) HTTPS",
      "B) DNSSEC",
      "C) TLS",
      "D) VPN"
    ],
    "correct_answer": "B",
    "explanation": "**DNSSEC (Domain Name System Security Extensions)** is de specifiek voor DNS ontworpen beveiligingsmaatregel die data-integriteit en authenticatie van DNS-antwoorden garandeert. DNSSEC werd ontwikkeld om de fundamentele beveiligingsproblemen van het originele DNS-protocol aan te pakken.\n\n**Hoe DNSSEC werkt:**\n\n1. **Digitale handtekeningen**: Elke DNS-record wordt voorzien van een digitale handtekening (RRSIG record)\n2. **Cryptografische sleutels**: Publieke sleutels (DNSKEY records) worden gebruikt om handtekeningen te verifi√´ren\n3. **Chain of trust**: Een hi√´rarchische vertrouwensketen loopt van de root zone naar individuele domeinen\n4. **Validatie**: DNS-resolvers kunnen de authenticiteit van elke respons verifi√´ren\n\n**Waarom DNSSEC cruciaal is:**\n\n- **Voorkomt cache poisoning**: Valse DNS-records kunnen niet worden ge√Ønjecteerd omdat ze geen geldige handtekening hebben\n- **Data integriteit**: Garandeert dat DNS-data niet is gemanipuleerd tijdens transport\n- **Authenticatie**: Bevestigt dat DNS-antwoorden afkomstig zijn van de geautoriseerde bron\n\n**DNSSEC implementatie proces:**\n\n1. **Zone signing**: De DNS-zone wordt ondertekend met cryptografische sleutels\n2. **Key management**: Zowel Zone Signing Keys (ZSK) als Key Signing Keys (KSK) worden beheerd\n3. **DS record**: Een Delegation Signer record wordt geplaatst in de parent zone\n4. **Validatie**: Resolvers valideren de chain of trust\n\n**Waarom de andere opties fout zijn:**\n\n- **HTTPS**: Versleutelt web verkeer maar heeft geen directe relatie met DNS-authenticatie\n- **TLS**: Versleutelt transportlagen maar is niet specifiek voor DNS (hoewel DNS over TLS bestaat)\n- **VPN**: Cre√´ert een veilige tunnel maar authenticeert geen DNS-data\n\n**Praktische overwegingen:**\n\n- **Performance impact**: DNSSEC voegt overhead toe aan DNS-queries maar moderne systemen kunnen dit goed aan\n- **Key rollover**: Regelmatige sleutelwisseling is essentieel voor beveiliging\n- **Deployment challenges**: Vereist co√∂rdinatie tussen registrars en DNS-providers\n\n**DNSSEC adoptie:**\nOndanks dat DNSSEC sinds 1999 beschikbaar is, is de adoptie nog steeds beperkt door complexiteit en gebrek aan bewustzijn. Echter, de toename van DNS-aanvallen maakt implementatie steeds belangrijker voor organisaties."
  },
  {
    "id": 3,
    "title": "DNS Amplification Attacks",
    "question": "Wat is een DNS amplification attack?",
    "options": [
      "A) Een fysieke aanval op DNS servers",
      "B) Een DDoS aanval die DNS servers gebruikt voor verkeersamplificatie",
      "C) Een aanval die DNS configuraties wijzigt",
      "D) Een aanval op DNS zone files"
    ],
    "correct_answer": "B",
    "explanation": "Een **DNS amplification attack** is een sophisticated vorm van Distributed Denial of Service (DDoS) aanval waarbij aanvallers DNS servers misbruiken om massale hoeveelheden verkeer naar een doelwit te sturen. Deze aanval exploiteert het asymmetrische karakter van DNS-communicatie waar een kleine query een veel grotere respons kan genereren.\n\n**Hoe DNS amplification werkt:**\n\n1. **Query spoofing**: Aanvallers sturen kleine DNS-queries naar open DNS-resolvers met het IP-adres van het doelwit als bron\n2. **Amplificatie effect**: De DNS-server stuurt een veel grotere respons naar het doelwit (amplificatie factor kan 28-179x zijn)\n3. **Botnet deployment**: Duizenden gecompromitteerde systemen voeren gelijktijdig deze queries uit\n4. **Doelwit overspoeling**: Het doelwit wordt overspoeld met ongewenst DNS-verkeer\n\n**Waarom dit zo effectief is:**\n\n- **Asymmetrie**: Een 60-byte query kan een 4000-byte respons genereren\n- **Legitimiteit**: DNS-verkeer wordt zelden geblokkeerd door firewalls\n- **Schaal**: Miljoenen open DNS-resolvers kunnen worden misbruikt\n- **Verberging**: Het echte IP-adres van de aanvaller blijft verborgen\n\n**Real-world voorbeelden:**\n\n- **Spamhaus attack (2013)**: 300 Gbps DNS amplification aanval\n- **GitHub attack (2018)**: 1.3 Tbps memcached amplification aanval\n- **Google attacks**: Regelmatige DNS amplification aanvallen tegen Google services\n\n**Impact van DNS amplification attacks:**\n\n- **Service disruption**: Websites en services worden ontoegankelijk\n- **Collateral damage**: Legitimie DNS-servers raken overbelast\n- **Economic losses**: Downtime kost organisaties gemiddeld \\$942.000 per incident\n\n**Detectie en verdediging:**\n\n1. **Traffic monitoring**: Ongebruikelijke spikes in uitgaand DNS-verkeer\n2. **Rate limiting**: Beperking van queries per seconde per bron\n3. **Response rate limiting (RRL)**: Beperkt antwoorden naar verdachte bronnen\n4. **BCP38 implementatie**: Internet Service Providers blokkeren gespoofde verkeer\n5. **DNS resolver hardening**: Configuratie van resolvers om misbruik te voorkomen\n\n**Waarom de andere opties fout zijn:**\n\n- **Optie A**: Het is geen fysieke aanval, maar een netwerkgebaseerde aanval\n- **Optie C**: Het wijzigt geen DNS-configuraties maar misbruikt bestaande servers\n- **Optie D**: Het valt geen zone files aan maar gebruikt servers als versterker\n\n**Preventie maatregelen voor organisaties:**\n\n- **DDoS protection services**: Cloud-based bescherming tegen volumetrische aanvallen\n- **Bandwidth over-provisioning**: Voldoende capaciteit om aanvallen te absorberen\n- **Incident response plan**: Voorbereid zijn op snelle reactie bij aanvallen"
  },
  {
    "id": 4,
    "title": "DNS over HTTPS (DoH)",
    "question": "Welke standaard poort gebruikt DNS over HTTPS (DoH)?",
    "options": [
      "A) Port 53",
      "B) Port 80",
      "C) Port 443",
      "D) Port 8080"
    ],
    "correct_answer": "C",
    "explanation": "**DNS over HTTPS (DoH)** gebruikt **poort 443**, dezelfde poort als standaard HTTPS verkeer. Dit is een fundamenteel aspect van DoH dat het onderscheidt van traditionele DNS en zelfs van DNS over TLS (DoT).\n\n**Waarom poort 443:**\n\n- **Camouflage**: DoH-verkeer is onzichtbaar tussen regulier HTTPS-verkeer\n- **Firewall bypass**: Poort 443 wordt vrijwel nooit geblokkeerd door firewalls\n- **Standaardisatie**: Maakt gebruik van bestaande HTTPS-infrastructuur\n\n**DoH vs andere DNS implementaties:**\n\n- **Traditionele DNS**: Gebruikt poort 53 (UDP/TCP) - onversleuteld\n- **DNS over TLS (DoT)**: Gebruikt poort 853 - versleuteld maar zichtbaar\n- **DNS over HTTPS (DoH)**: Gebruikt poort 443 - versleuteld en verborgen\n\n**Hoe DoH werkt:**\n\n1. **HTTPS wrapper**: DNS-queries worden verpakt in HTTPS-requests\n2. **HTTP/2 protocol**: Vaak gebruikt voor effici√´nte communicatie\n3. **GET/POST methods**: DNS-data wordt gecodeerd in HTTP-berichten\n4. **TLS encryption**: Volledige versleuteling van DNS-communicatie\n\n**Voordelen van DoH:**\n\n- **Privacy bescherming**: ISP's kunnen DNS-queries niet meer onderscheppen\n- **Censorship resistance**: Moeilijker te blokkeren door autoritaire regimes\n- **Man-in-the-middle prevention**: TLS-versleuteling voorkomt tampering\n- **DNS spoofing protection**: Versleuteling voorkomt query manipulation\n\n**Security uitdagingen:**\n\n- **Enterprise visibility**: IT-afdelingen verliezen zicht op DNS-verkeer\n- **DNS filtering bypass**: Werknemers kunnen security policies omzeilen\n- **Malware communication**: Kwaadaardige software kan C2-communicatie verbergen\n- **Compliance issues**: Moeilijker om aan logging-vereisten te voldoen\n\n**DoH servers in Nederland:**\nVerschillende providers bieden DoH-services aan:\n\n- **Cloudflare**: `https://1.1.1.1/dns-query`\n- **Google**: `https://dns.google/dns-query`\n- **Quad9**: `https://dns.quad9.net/dns-query`\n\n**Implementatie overwegingen:**\n\n1. **Browser support**: Chrome, Firefox, Edge ondersteunen DoH native\n2. **OS integration**: Windows 11 heeft ingebouwde DoH-ondersteuning\n3. **Network policies**: Organisaties moeten DoH-beleid defini√´ren\n4. **Performance impact**: Minimale overhead door HTTP/2 multiplexing\n\n**Waarom de andere opties fout zijn:**\n\n- **Port 53**: Dit is de traditionele DNS-poort, niet DoH\n- **Port 80**: Dit is HTTP (onversleuteld), niet HTTPS\n- **Port 8080**: Dit is een alternatieve web poort, niet standaard voor DoH\n\n**Enterprise DoH management:**\nVoor organisaties die DoH willen implementeren zonder security risico's:\n\n- **Controlled DoH servers**: Gebruik van interne of vertrouwde DoH-providers\n- **Policy enforcement**: GPO's voor browser DoH-configuratie\n- **Monitoring solutions**: Tools die DoH-verkeer kunnen analyseren\n- **Hybrid approaches**: Combinatie van DoH en traditionele DNS-filtering"
  },
  {
    "id": 5,
    "title": "DNS Tunneling",
    "question": "Wat is de primaire reden waarom DNS tunneling een beveiligingsrisico vormt?",
    "options": [
      "A) Het vertraagt DNS queries",
      "B) Het maakt DNS queries onleesbaar",
      "C) Het staat aanvallers toe data te exfiltreren via DNS queries",
      "D) Het gebruikt teveel bandbreedte"
    ],
    "correct_answer": "C",
    "explanation": "**DNS tunneling** vormt een significant beveiligingsrisico omdat **het aanvallers toestaat om data te exfiltreren via DNS queries**, waarbij ze de DNS-infrastructuur misbruiken als een verborgen communicatiekanaal. Deze techniek exploiteert het feit dat DNS-verkeer vrijwel altijd wordt toegestaan door firewalls en security systemen.\n\n**Hoe DNS tunneling werkt:**\n\n1. **Data encoding**: Gevoelige data wordt gecodeerd in DNS-queries of -responses\n2. **Subdomain misbruik**: Data wordt verborgen in lange subdomain namen\n3. **TXT record abuse**: Grote hoeveelheden data kunnen worden verborgen in TXT records\n4. **Bidirectional communication**: Zowel data exfiltratie als command \\& control communicatie\n\n**Waarom DNS tunneling zo gevaarlijk is:**\n\n- **Firewall bypass**: DNS-verkeer wordt zelden geblokkeerd of ge√Ønspecteerd\n- **Stealth communication**: Verbergt kwaadaardige activiteit in legitiem uitziend verkeer\n- **Detection evasion**: Moeilijk te onderscheiden van normale DNS-activiteit\n- **Persistent access**: Kan langdurige backdoors cre√´ren\n\n**Praktische toepassingen door aanvallers:**\n\n1. **Data exfiltratie**: Stelen van gevoelige bestanden via DNS queries\n2. **Command \\& Control**: Remote besturing van ge√Ønfecteerde systemen\n3. **Malware communication**: Communicatie tussen malware en C2-servers\n4. **Persistence mechanism**: Onderhouden van toegang na initi√´le compromittatie\n\n**Real-world voorbeelden:**\n\n- **Godlua malware (2019)**: Eerste malware die DoH voor DNS tunneling gebruikte\n- **ChamelDoH**: Chinese threat group die Linux systemen infecteerde\n- **APT groups**: Geavanceerde persistent threats gebruiken DNS tunneling voor stealthy exfiltratie\n\n**Detectie van DNS tunneling:**\n\n1. **Anomaly detection**: Ongebruikelijke DNS query patronen\n2. **Query length analysis**: Abnormaal lange domain namen\n3. **Frequency monitoring**: Hoge frequentie van DNS queries van √©√©n host\n4. **Payload analysis**: Inspectie van DNS query content\n5. **Baseline comparison**: Vergelijking met normale DNS-patronen\n\n**Verdedigingsstrategie√´n:**\n\n- **DNS monitoring**: Real-time analyse van DNS-verkeer\n- **Deep packet inspection**: Gedetailleerde inspectie van DNS-payloads\n- **Behavioral analysis**: Machine learning voor anomalie detectie\n- **DNS filtering**: Blokkeren van verdachte domains\n- **Network segmentation**: Beperking van DNS-toegang\n\n**Waarom de andere opties fout zijn:**\n\n- **Optie A**: DNS tunneling kan queries vertragen, maar dit is niet het primaire risico\n- **Optie B**: Het maakt queries niet onleesbaar, maar verbergt data erin\n- **Optie D**: Bandbreedtegebruik is niet het hoofdprobleem\n\n**Preventieve maatregelen:**\n\n1. **DNS policy enforcement**: Restrictieve DNS-policies implementeren\n2. **Egress filtering**: Uitgaand DNS-verkeer controleren\n3. **DNS over HTTPS management**: Gecontroleerde DoH-implementatie\n4. **User education**: Bewustwording van DNS tunneling risico's\n5. **Incident response**: Procedures voor DNS tunneling detectie\n\n**Monitoring tools:**\n\n- **DNS monitoring platforms**: Gespecialiseerde tools voor DNS-analyse\n- **SIEM integration**: Correlatie van DNS-logs met andere security events\n- **Machine learning**: AI-gedreven detectie van abnormaal DNS-gedrag"
  },
  {
    "id": 6,
    "title": "DNS Record Types voor Security",
    "question": "Welke van de volgende DNS record types wordt voornamelijk gebruikt voor e-mail authenticatie en anti-spam doeleinden?",
    "options": [
      "A) A record",
      "B) CNAME record",
      "C) TXT record",
      "D) MX record"
    ],
    "correct_answer": "C",
    "explanation": "**TXT records** worden voornamelijk gebruikt voor e-mail authenticatie en anti-spam doeleinden. Hoewel TXT records oorspronkelijk bedoeld waren voor het opslaan van willekeurige tekstinformatie, zijn ze ge√´volueerd tot een cruciaal onderdeel van e-mail security en domain verificatie.\n\n**E-mail authenticatie met TXT records:**\n\n**1. SPF (Sender Policy Framework)**\n\n```\nexample.com. TXT \"v=spf1 include:_spf.google.com ~all\"\n```\n\n- **Functie**: Specificeert welke servers geautoriseerd zijn om e-mail te verzenden namens het domein\n- **Anti-spoofing**: Voorkomt dat aanvallers e-mails verzenden alsof ze van jouw domein komen\n- **Mechanisme**: Ontvangende servers controleren of de verzendende server geautoriseerd is\n\n**2. DKIM (DomainKeys Identified Mail)**\n\n```\nselector._domainkey.example.com. TXT \"v=DKIM1; k=rsa; p=MIGfMA0GCSqGSIb3...\"\n```\n\n- **Digitale handtekening**: Voegt cryptografische handtekening toe aan e-mails\n- **Message integrity**: Garandeert dat e-mail content niet is gewijzigd\n- **Reputation binding**: Koppelt e-mail aan het verzendende domein\n\n**3. DMARC (Domain-based Message Authentication)**\n\n```\n_dmarc.example.com. TXT \"v=DMARC1; p=quarantine; rua=mailto:dmarc@example.com\"\n```\n\n- **Policy enforcement**: Defineert wat te doen met e-mails die SPF/DKIM falen\n- **Reporting**: Verzamelt feedback over e-mail authenticatie resultaten\n- **Phishing protection**: Voorkomt misbruik van domein voor phishing\n\n**Andere security toepassingen van TXT records:**\n\n**Domain verificatie:**\n\n- **Google Site Verification**: `google-site-verification=abcd1234...`\n- **Microsoft 365**: `MS=ms12345678`\n- **SSL certificaat validatie**: Voor Let's Encrypt en andere CA's\n\n**Security policies:**\n\n- **CAA records**: Certificaat Authority Authorization (hoewel er een specifiek CAA record type bestaat, wordt soms TXT gebruikt)\n- **Security.txt**: Bevat contact informatie voor security researchers\n\n**Waarom TXT records ideaal zijn voor security:**\n\n1. **Flexibiliteit**: Kunnen willekeurige data bevatten\n2. **Standaardisatie**: Breed ondersteund door alle DNS-implementaties\n3. **Parsing**: Eenvoudig te interpreteren door applicaties\n4. **Updates**: Makkelijk te wijzigen zonder DNS-infrastructuur aanpassingen\n\n**Waarom de andere opties minder geschikt zijn:**\n\n- **A record**: Wijst naar IP-adressen, niet geschikt voor tekstuele authenticatie data\n- **CNAME record**: Cre√´ert aliassen, geen authenticatie functionaliteit\n- **MX record**: Specificeert mail servers maar bevat geen authenticatie informatie\n\n**Security best practices voor TXT records:**\n\n1. **Regular auditing**: Regelmatige controle van TXT records op ongeautoriseerde wijzigingen\n2. **SPF hardening**: Gebruik van \"-all\" in plaats van \"~all\" voor strikte policy\n3. **DMARC progression**: Geleidelijke overgang van \"p=none\" naar \"p=quarantine\" naar \"p=reject\"\n4. **Monitoring**: Analyse van DMARC rapporten voor detectie van misbruik\n\n**DNS security implicaties:**\n\n- **Record poisoning**: TXT records kunnen doelwit zijn van DNS cache poisoning\n- **DNSSEC importance**: Authenticatie van TXT records via DNSSEC is cruciaal\n- **Monitoring requirements**: Wijzigingen in security-gerelateerde TXT records moeten worden gemonitord\n\n**Penetration testing aspecten:**\nDNS reconnaissance vaak gericht op TXT records omdat ze waardevolle informatie kunnen bevatten:\n\n- **Information disclosure**: TXT records kunnen gevoelige configuratie details lekken\n- **Attack surface mapping**: SPF records onthullen geautoriseerde mail servers\n- **Social engineering**: Informatie uit TXT records kan gebruikt worden voor gerichte aanvallen"
  },
  {
    "id": 7,
    "title": "DNS Architecture Security",
    "question": "Wat is het belangrijkste voordeel van het scheiden van authoritative en recursive DNS servers?",
    "options": [
      "A) Betere prestaties",
      "B) Lagere kosten",
      "C) Verkleinen van attack surface",
      "D) Eenvoudigere configuratie"
    ],
    "correct_answer": "C",
    "explanation": "Het **verkleinen van de attack surface** is het belangrijkste beveiligingsvoordeel van het scheiden van authoritative en recursive DNS servers. Deze architecturale best practice is fundamenteel voor een robuuste DNS security strategie.\n\n**Waarom scheiding essentieel is:**\n\n**Authoritative servers:**\n\n- **Functie**: Bevatten de definitieve DNS-records voor specifieke zones\n- **Verantwoordelijkheid**: Beantwoorden alleen queries voor domeinen waarvoor ze autoritair zijn\n- **Exposure**: Hebben beperkte functionaliteit en zijn daarom moeilijker aan te vallen\n\n**Recursive servers:**\n\n- **Functie**: Lossen DNS-queries op namens clients door andere DNS-servers te bevragen\n- **Verantwoordelijkheid**: Cachen resultaten en bedienen interne gebruikers\n- **Complexity**: Complexere functionaliteit cre√´ert meer potenti√´le kwetsbaarheden\n\n**Attack surface reductie:**\n\n**1. Beperkte functionaliteit per server:**\n\n- Authoritative servers hoeven geen recursie uit te voeren\n- Recursive servers hoeven geen autoritaire data te bevatten\n- Elke server heeft specifieke, beperkte verantwoordelijkheden\n\n**2. Verschillende beveiligingspolicies:**\n\n- **Authoritative servers**: Kunnen strikt worden geconfigureerd om alleen geautoriseerde queries te beantwoorden\n- **Recursive servers**: Kunnen worden geconfigureerd met toegangscontroles voor interne clients\n\n**3. Ge√Øsoleerde failure modes:**\n\n- Compromittatie van een recursive server be√Ønvloedt niet de autoritaire data\n- Aanvallen op authoritative servers be√Ønvloeden niet de interne DNS-resolutie\n\n**Specifieke beveiligingsvoordelen:**\n\n**Tegen DNS poisoning:**\n\n- Authoritative servers kunnen niet worden gebruikt voor cache poisoning omdat ze geen cache hebben\n- Recursive servers kunnen worden beschermd met specifieke anti-poisoning maatregelen\n\n**Tegen DDoS aanvallen:**\n\n- Aanvallen op authoritative servers be√Ønvloeden niet interne DNS-resolutie\n- Recursive servers kunnen worden beschermd achter firewalls\n\n**Tegen reconnaissance:**\n\n- Authoritative servers lekken geen informatie over interne netwerkstructuur\n- Recursive servers zijn niet toegankelijk vanaf internet\n\n**NIST 800-53 compliance:**\nDeze scheiding wordt specifiek vereist door meerdere NIST controls:\n\n- **SC-20**: Secure Name/Address Resolution Service\n- **SC-21**: Secure Name/Address Resolution Service (Recursive/Caching)\n- **SI-4**: Information System Monitoring\n\n**Implementatie best practices:**\n\n**1. Network segmentation:**\n\n```\nInternet ‚Üí Authoritative servers (DMZ)\nInternal network ‚Üí Recursive servers (Internal)\n```\n\n**2. Access controls:**\n\n- Authoritative servers: Alleen toegankelijk voor legitieme DNS-queries\n- Recursive servers: Alleen toegankelijk voor interne clients\n\n**3. Monitoring en logging:**\n\n- Gescheiden logging voor verschillende server types\n- Specifieke monitoring voor elke server rol\n\n**Waarom de andere opties minder belangrijk zijn:**\n\n- **Prestaties**: Hoewel scheiding prestaties kan verbeteren, is dit niet het primaire security doel\n- **Kosten**: Security is belangrijker dan kostenbesparingen\n- **Configuratie**: Scheiding maakt configuratie complexer, niet eenvoudiger\n\n**Common misconfigurations:**\n\n1. **Open recursive resolvers**: Recursive servers toegankelijk vanaf internet\n2. **Combined functionality**: Servers die zowel autoritair als recursief zijn\n3. **Inadequate access controls**: Ontbrekende restricties op DNS-queries\n\n**Real-world impact:**\nOrganisaties die deze scheiding niet implementeren zijn kwetsbaarder voor:\n\n- **DNS amplification attacks**: Misbruik van open resolvers\n- **Cache poisoning**: Compromittatie van gecombineerde servers\n- **Information disclosure**: Lekken van interne netwerkdetails\n\n**Monitoring en maintenance:**\n\n- **Regular audits**: Controle op correcte scheiding en configuratie\n- **Security updates**: Verschillende update schedules voor verschillende server types\n- **Incident response**: Specifieke procedures voor elke server type"
  },
  {
    "id": 8,
    "title": "DNS Reconnaissance",
    "question": "Welke techniek wordt gebruikt tijdens penetration testing om subdomains van een target domain te ontdekken?",
    "options": [
      "A) Port scanning",
      "B) DNS enumeration",
      "C) Social engineering",
      "D) Brute force attacks"
    ],
    "correct_answer": "B",
    "explanation": "**DNS enumeration** is de primaire techniek die wordt gebruikt tijdens penetration testing om subdomains van een target domain te ontdekken. Deze reconnaissance techniek is een fundamenteel onderdeel van de information gathering fase van een penetratie test.\n\n**Wat is DNS enumeration:**\nDNS enumeration is het systematisch verzamelen van DNS-gerelateerde informatie over een doeldomein, inclusief:\n\n- Subdomains en hostnames\n- IP-adressen en netwerkranges\n- DNS-records (A, MX, NS, TXT, etc.)\n- Mail servers en nameservers\n\n**Subdomain discovery technieken:**\n\n**1. Passive enumeration:**\n\n- **Certificate transparency logs**: Zoeken naar SSL-certificaten\n- **Search engine dorking**: Google, Bing queries voor subdomains\n- **DNS databases**: Gebruik van historische DNS-data\n- **OSINT platforms**: SecurityTrails, VirusTotal, Shodan\n\n**2. Active enumeration:**\n\n- **Brute force**: Woordenlijsten gebruiken om subdomains te raden\n- **Zone transfers**: Proberen AXFR requests uit te voeren\n- **DNS walking**: Systematisch doorlopen van DNS-zones\n- **Reverse DNS**: IP-ranges scannen voor PTR records\n\n**Populaire DNS enumeration tools:**\n\n**Command-line tools:**\n\n- **dig**: Basis DNS-queries uitvoeren\n- **nslookup**: DNS-records opvragen\n- **host**: Simpele DNS-lookups\n- **dnsrecon**: Uitgebreide DNS-reconnaissance\n\n**Gespecialiseerde tools:**\n\n- **Sublist3r**: Automatische subdomain discovery\n- **Amass**: Uitgebreide subdomain enumeration\n- **Subfinder**: Snelle subdomain scanner\n- **Fierce**: DNS-reconnaissance tool\n- **DNSenum**: Comprehensive DNS enumeration\n\n**Praktische enumeration workflow:**\n\n**Stap 1: Basic information gathering**\n\n```bash\nwhois example.com\ndig example.com any\nnslookup example.com\n```\n\n**Stap 2: Subdomain discovery**\n\n```bash\nsublist3r -d example.com\namass enum -d example.com\nsubfinder -d example.com\n```\n\n**Stap 3: Zone transfer attempts**\n\n```bash\ndig AXFR example.com @ns1.example.com\ndnsrecon -d example.com -t axfr\n```\n\n**Waarom subdomain discovery belangrijk is:**\n\n1. **Attack surface expansion**: Meer potenti√´le entry points\n2. **Hidden services**: Development/staging environments\n3. **Forgotten assets**: Oude of onbeheerde subdomains\n4. **Vulnerable applications**: Outdated software op subdomains\n\n**Security implicaties voor defenders:**\n\n**Risico's van excessive enumeration:**\n\n- **Information disclosure**: Teveel informatie beschikbaar maken\n- **Shadow IT**: Onbekende subdomains binnen de organisatie\n- **Subdomain takeover**: Niet-geclaimde DNS-records\n\n**Defensieve maatregelen:**\n\n1. **DNS monitoring**: Detectie van enumeration activiteiten\n2. **Rate limiting**: Beperking van DNS-queries per IP\n3. **Information minimization**: Alleen noodzakelijke DNS-records publiceren\n4. **Regular auditing**: Inventarisatie van alle subdomains\n\n**Waarom de andere opties minder accuraat zijn:**\n\n- **Port scanning**: Ontdekt open poorten maar niet specifiek subdomains\n- **Social engineering**: Kan informatie opleveren maar is niet de primaire methode\n- **Brute force attacks**: Is een techniek binnen DNS enumeration, niet de overkoepelende methode\n\n**Detection en response:**\n\n**Indicators of enumeration:**\n\n- Hoge volumes DNS-queries van √©√©n IP\n- Queries naar niet-bestaande subdomains\n- Systematische AXFR-requests\n- Ongebruikelijke query patterns\n\n**Response strategies:**\n\n- **IP blocking**: Temporaire blokkering van verdachte IPs\n- **Rate limiting**: DNS query throttling\n- **Honeypots**: Fake subdomains voor detectie\n- **Logging enhancement**: Uitgebreide DNS query logging\n\n**Ethical considerations:**\nDNS enumeration in een penetratie test context:\n\n- **Authorization**: Alleen met expliciete toestemming\n- **Scope definition**: Duidelijke grenzen van de test\n- **Impact minimization**: Vermijd verstoring van services\n- **Reporting**: Documentatie van gevonden kwetsbaarheden"
  },
  {
    "id": 9,
    "title": "DNS Security Incident Response",
    "question": "Wat is de aanbevolen actie bij het detecteren van ongebruikelijke DNS query patronen die wijzen op mogelijke DNS tunneling?",
    "options": [
      "A) Negeren van de activiteit",
      "B) Direct alle DNS verkeer blokkeren",
      "C) Gedetailleerde analyse van de queries uitvoeren",
      "D) De DNS server herstarten"
    ],
    "correct_answer": "C",
    "explanation": "**Gedetailleerde analyse van de queries uitvoeren** is de aanbevolen eerste actie bij detectie van mogelijke DNS tunneling. DNS tunneling is een sophisticated aanvalstechniek die zorgvuldige analyse vereist om false positives te vermijden en de werkelijke omvang van de bedreiging te begrijpen.\n\n**Waarom gedetailleerde analyse cruciaal is:**\n\n**1. False positive reductie:**\n\n- Legitieme applicaties kunnen ongebruikelijke DNS-patronen vertonen\n- Automatische updates, CDN's en cloud services genereren veel DNS-verkeer\n- Overhaaste reacties kunnen legitieme services verstoren\n\n**2. Threat intelligence gathering:**\n\n- Identificatie van aanvalspatronen en IOC's\n- Bepaling van de scope en impact van de aanval\n- Verzameling van forensische gegevens voor verdere actie\n\n**DNS tunneling analyse framework:**\n\n**Stap 1: Query pattern analysis**\n\n```\n- Query frequentie: Abnormaal hoge DNS-activiteit van specifieke hosts\n- Query length: Ongebruikelijk lange subdomain namen (>50 karakters)\n- Query entropy: Hoge randomness in query content\n- Query timing: Regelmatige intervals of burst patronen\n```\n\n**Stap 2: Content inspection**\n\n```\n- Encoded data detection: Base64, hex, of andere encoding schemes\n- Payload analysis: Data verborgen in subdomain labels\n- Response analysis: Ongebruikelijke TXT record content\n- Protocol analysis: Non-standard DNS record types\n```\n\n**Stap 3: Network correlation**\n\n```\n- Source identification: Welke hosts genereren verdacht verkeer\n- Destination analysis: Naar welke domains worden queries gestuurd\n- Timeline reconstruction: Wanneer begon de activiteit\n- Volume assessment: Hoeveel data wordt mogelijk ge√´xfiltreerd\n```\n\n**Praktische analyse tools:**\n\n**SIEM-based analysis:**\n\n- **Log correlation**: DNS-logs correleren met andere security events\n- **Anomaly detection**: Machine learning voor pattern recognition\n- **Baseline comparison**: Vergelijking met normale DNS-patronen\n\n**Specialized DNS analysis tools:**\n\n- **DNS monitoring platforms**: Real-time analyse van DNS-verkeer\n- **Network forensics**: Gedetailleerde packet inspection\n- **Threat intelligence**: Correlatie met bekende IOC's\n\n**Immediate containment actions (na analyse):**\n\n**Als DNS tunneling wordt bevestigd:**\n\n1. **Isolated containment**: Beperking van verdachte hosts zonder volledig blokkeren\n2. **Traffic redirection**: Omleiding van queries naar sinkhole\n3. **Enhanced monitoring**: Verhoogde logging van DNS-activiteit\n4. **Stakeholder notification**: Informatie aan relevant personeel\n\n**Evidence preservation:**\n\n- **Log retention**: Bewaring van relevante DNS-logs\n- **Packet captures**: Network forensics data\n- **System images**: Forensische kopie√´n van gecompromitteerde systemen\n- **Chain of custody**: Proper documentatie voor juridische doeleinden\n\n**Waarom de andere opties problematisch zijn:**\n\n**Optie A (Negeren):**\n\n- DNS tunneling kan leiden tot significante data exfiltratie\n- Aanvallers krijgen de kans om hun positie te versterken\n- Mogelijke compliance schendingen\n\n**Optie B (Volledig blokkeren):**\n\n- Kan legitieme services verstoren\n- Voorkomt verdere analyse en threat intelligence gathering\n- Mogelijk disproportionele response\n\n**Optie D (Server restart):**\n\n- Lost belangrijke forensische gegevens\n- Verstoort alle DNS-services\n- Adresseert niet de onderliggende bedreiging\n\n**Long-term remediation:**\n\n**Technical controls:**\n\n- **DNS filtering enhancement**: Betere detectie van tunneling patterns\n- **Egress filtering**: Restrictieve uitgaande DNS policies\n- **Monitoring improvements**: Enhanced DNS visibility\n\n**Process improvements:**\n\n- **Incident response procedures**: Gedetailleerde playbooks voor DNS-incidenten\n- **Staff training**: Educatie over DNS tunneling detectie\n- **Regular drills**: Oefening van incident response procedures\n\n**Compliance considerations:**\nVeel compliance frameworks vereisen:\n\n- **Incident documentation**: Gedetailleerde rapportage van security incidenten\n- **Response timeliness**: Snelle maar doordachte reactie op bedreigingen\n- **Forensic capability**: Vermogen tot technische analyse\n\n**Preventive measures:**\n\n- **DNS over HTTPS management**: Gecontroleerde implementatie van DoH\n- **Network segmentation**: Beperking van DNS-toegang\n- **User education**: Bewustwording van DNS-gebaseerde bedreigingen"
  },
  {
    "id": 10,
    "title": "DNS Security Compliance",
    "question": "Welke compliance framework bevat specifieke vereisten voor DNS monitoring en logging?",
    "options": [
      "A) GDPR",
      "B) ISO 27001",
      "C) PCI DSS",
      "D) HIPAA"
    ],
    "correct_answer": "C",
    "explanation": "**PCI DSS (Payment Card Industry Data Security Standard)** bevat specifieke en expliciete vereisten voor DNS monitoring en logging. PCI DSS 4.0, de meest recente versie, heeft DNS security als een prominente component van de compliance vereisten ge√Øntroduceerd.\n\n**Specifieke PCI DSS DNS vereisten:**\n\n**Requirement 10 - Logging en monitoring:**\nPCI DSS benadrukt dat DNS-queries en -responses een belangrijke databron zijn voor netwerkdefenders ter ondersteuning van incident response en intrusion discovery.\n\n**Requirement 11.5.1.1 (Service Providers):**\n\"Additional requirement for service providers only: Intrusion-detection and/or intrusion-prevention techniques detect, alert on/prevent, and address covert channels\"\n\nPCI SSC guidance specificeert dat DNS-queries en -responses essenti√´le data zijn voor:\n\n- **Incident response**: Forensische analyse van security incidenten\n- **Intrusion discovery**: Detectie van ongeautoriseerde toegang\n- **Network defense**: Proactieve bedreiging detectie\n\n**Requirement 6.1 - Vulnerability management:**\nDNS-based security biedt een aantrekkelijke oplossing voor netwerkmonitoring en -controle omdat DNS een universele sensor is die de basis vormt van alle netwerkactiviteit.\n\n**Waarom PCI DSS DNS monitoring benadrukt:**\n\n**1. Payment data protection:**\n\n- DNS kan worden misbruikt voor credit card data exfiltratie\n- DNS tunneling kan payment processing systemen compromitteren\n- DNS spoofing kan leiden tot frauduleuze transactions\n\n**2. Network visibility:**\n\n- DNS-verkeer biedt inzicht in alle netwerkactiviteit\n- Critical voor detectie van payment data breaches\n- Essential for forensic investigations\n\n**Praktische PCI DSS DNS implementatie:**\n\n**Logging requirements:**\n\n```\n- Alle DNS queries en responses loggen\n- Timestamp en source IP tracking\n- Query type en response analysis\n- Anomaly detection en alerting\n```\n\n**Monitoring controls:**\n\n```\n- Real-time DNS traffic analysis\n- Automated alerting voor abnormal patterns  \n- Integration met SIEM systems\n- Regular log review en analysis\n```\n\n**Waarom andere frameworks minder specifiek zijn:**\n\n**GDPR (Optie A):**\n\n- Focust op privacy en data protection\n- Geen specifieke technische DNS vereisten\n- Wel relevant voor DNS data retention policies\n\n**ISO 27001 (Optie B):**\n\n- Breed information security management framework\n- Bevat algemene monitoring vereisten\n- Geen specifieke DNS monitoring mandates\n\n**HIPAA (Optie D):**\n\n- Healthcare-specific privacy en security\n- Algemene security controls maar geen DNS specifics\n- Technical safeguards zijn breed gedefinieerd\n\n**Andere compliance frameworks met DNS componenten:**\n\n**NIST Cybersecurity Framework:**\n\n- **PR.IR-03**: Technology Infrastructure Resilience\n- Implementatie voorbeelden bevatten DNS redundancy\n- Emphasis op single points of failure eliminatie\n\n**NIST 800-53:**\n\n- **SC-20**: Secure Name/Address Resolution Service\n- **SC-21**: Secure Name/Address Resolution Service (Recursive)\n- **SI-4**: Information System Monitoring met DNS componenten\n\n**NIS2 Directive (EU):**\nNieuwe Europese wetgeving die DNS security expliciet adresseert:\n\n- Protective DNS implementatie vereisten\n- DNS incident rapportage verplichtingen\n- Critical infrastructure DNS protection\n\n**PCI DSS DNS compliance best practices:**\n\n**1. Comprehensive logging:**\n\n- **Query logging**: Alle DNS requests documenteren\n- **Response logging**: DNS answers en return codes\n- **Error logging**: Failed queries en timeouts\n- **Performance metrics**: Response times en availability\n\n**2. Real-time monitoring:**\n\n- **Anomaly detection**: Unusual query patterns\n- **Threat intelligence**: IOC correlation\n- **Automated alerting**: Immediate notification van incidents\n- **Dashboard visualization**: Real-time DNS health monitoring\n\n**3. Incident response integration:**\n\n- **SIEM integration**: DNS logs in centralized platform\n- **Forensic readiness**: Proper log retention en analysis\n- **Playbook development**: DNS-specific incident procedures\n- **Staff training**: DNS security awareness\n\n**Audit considerations:**\nPCI DSS assessors zullen verificeren:\n\n- **DNS logging coverage**: Comprehensive query/response logging\n- **Monitoring effectiveness**: Detection capability demonstration\n- **Incident response**: DNS-related procedure testing\n- **Evidence retention**: Proper forensic log management\n\n**Business impact:**\nNon-compliance met PCI DSS DNS requirements kan leiden tot:\n\n- **Financial penalties**: Fines van card brands\n- **Audit findings**: Failed PCI assessments\n- **Business disruption**: Loss of payment processing capability\n- **Reputation damage**: Customer trust erosion"
  }
]</script>
    <script>
        const quizData = JSON.parse(document.getElementById('quiz-data').textContent);
        let current = 0;
        let score = 0;

        const qTitle = document.getElementById('question-title');
        const qText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const progressEl = document.getElementById('progress');
        const feedback = document.getElementById('feedback');
        const explanationEl = document.getElementById('explanation');
        const nextBtn = document.getElementById('next-btn');
        const resultsEl = document.getElementById('results');
        const questionSection = document.getElementById('question-section');
        const scoreNumberEl = document.getElementById('score-number');
        const scorePercentageEl = document.getElementById('score-percentage');
        const scoreMessageEl = document.getElementById('score-message');
        const restartBtn = document.getElementById('restart-btn');

        function renderQuestion() {
            const q = quizData[current];
            qTitle.textContent = `${q.id}. ${q.title}`;
            qText.textContent = q.question;
            progressEl.textContent = `Vraag ${current + 1} van ${quizData.length}`;

            optionsContainer.innerHTML = '';
            q.options.forEach((opt) => {
                const letter = opt.charAt(0);
                const text = opt.substring(3);
                const btn = document.createElement('button');
                btn.className = 'btn-option';
                btn.textContent = text;
                btn.onclick = () => handleAnswer(btn, letter, q.correct_answer, q.explanation);
                optionsContainer.appendChild(btn);
            });

            feedback.classList.add('hidden');

            // Reset scroll position of explanation container
            const explanationContainer = document.querySelector('.explanation-container');
            if (explanationContainer) {
                explanationContainer.scrollTop = 0;
            }
        }

        function handleAnswer(btn, selected, correct, explanation) {
            // Disable all buttons
            document.querySelectorAll('.btn-option').forEach((b) => {
                b.classList.add('disabled');
                b.disabled = true;
                const letter = b === btn ? selected : quizData[current].options.find(o => o.substring(3) === b.textContent).charAt(0);
                if (letter === correct) {
                    b.classList.add('correct');
                }
            });

            if (selected !== correct) {
                btn.classList.add('wrong');
            } else {
                score++;
            }

            // Show explanation with HTML formatting
            explanationEl.innerHTML = explanation.replace(/\n/g, '<br>');
            feedback.classList.remove('hidden');

            // Reset scroll position when showing feedback
            const explanationContainer = document.querySelector('.explanation-container');
            if (explanationContainer) {
                explanationContainer.scrollTop = 0;
            }

            // Last question?
            nextBtn.textContent = current + 1 === quizData.length ? 'Afronden' : 'Volgende vraag';
        }

        nextBtn.onclick = () => {
            current++;
            if (current < quizData.length) {
                renderQuestion();
            } else {
                showResults();
            }
        };

        function showResults() {
            questionSection.style.display = 'none';
            resultsEl.classList.remove('hidden');
            const pct = Math.round((score / quizData.length) * 100);
            scoreNumberEl.textContent = `${score} / ${quizData.length}`;
            scorePercentageEl.textContent = `${pct}%`;

            let message = '';
            if (pct >= 80) {
                message = 'Uitstekend! Je hebt uitstekende kennis van DNS security. üéâ';
            } else if (pct >= 60) {
                message = 'Goed gedaan! Je hebt goede basiskennis, maar er is ruimte voor verbetering. üëç';
            } else {
                message = 'Verbeter je kennis. Bestudeer de uitleg bij elke vraag om meer te leren over DNS security. üìö';
            }
            scoreMessageEl.textContent = message;
        }

        restartBtn.onclick = () => {
            current = 0;
            score = 0;
            questionSection.style.display = 'block';
            resultsEl.classList.add('hidden');
            renderQuestion();
        };

        // Initialize quiz
        renderQuestion();
    </script>
</body>
</html>